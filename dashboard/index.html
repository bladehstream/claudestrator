<!DOCTYPE html>
<html class="dark" lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>VulnDash // Vulnerability Dashboard</title>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com" rel="preconnect"/>
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

    <!-- Chart.js for trend visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#2b4bee",
                        "primary-glow": "#4d6df8",
                        "accent-pink": "#ff2a6d",
                        "accent-cyan": "#05d9e8",
                        "background-dark": "#050505",
                        "surface-dark": "#0f111a",
                        "surface-border": "#1f2335",
                    },
                    fontFamily: {
                        "display": ["Space Grotesk", "sans-serif"],
                        "mono": ["Space Grotesk", "monospace"]
                    },
                    borderRadius: {
                        "DEFAULT": "2px",
                        "sm": "2px",
                        "md": "4px",
                        "lg": "6px",
                        "xl": "8px",
                        "full": "9999px"
                    },
                    boxShadow: {
                        "neon": "0 0 5px theme('colors.primary'), 0 0 20px theme('colors.primary/20')",
                        "neon-pink": "0 0 5px theme('colors.accent-pink'), 0 0 20px theme('colors.accent-pink/20')",
                    }
                },
            },
        }
    </script>

    <style>
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #0f111a;
        }
        ::-webkit-scrollbar-thumb {
            background: #323b67;
            border-radius: 2px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #2b4bee;
        }

        .cyber-grid {
            background-image: linear-gradient(rgba(35, 41, 72, 0.2) 1px, transparent 1px),
            linear-gradient(90deg, rgba(35, 41, 72, 0.2) 1px, transparent 1px);
            background-size: 40px 40px;
        }

        .glass-panel {
            background: rgba(15, 17, 26, 0.7);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(43, 75, 238, 0.1);
        }

        .line-clamp-1 {
            overflow: hidden;
            display: -webkit-box;
            -webkit-box-orient: vertical;
            -webkit-line-clamp: 1;
        }

        @keyframes pulse-glow {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .animate-pulse-slow {
            animation: pulse-glow 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
    </style>
</head>

<body class="bg-background-dark text-white font-display cyber-grid min-h-screen flex flex-col overflow-x-hidden selection:bg-primary selection:text-white">

<!-- Header -->
<header class="sticky top-0 z-50 glass-panel border-b border-surface-border">
    <div class="px-6 py-3 flex items-center justify-between w-full">
        <div class="flex items-center gap-8">
            <!-- Logo -->
            <div class="flex items-center gap-3 text-white group cursor-pointer">
                <div class="size-8 flex items-center justify-center bg-primary/10 border border-primary text-primary rounded-sm shadow-neon">
                    <span class="material-symbols-outlined text-[20px]">security</span>
                </div>
                <div class="flex flex-col">
                    <h2 class="text-white text-lg font-bold leading-none tracking-tight">VULN<span class="text-primary">DASH</span></h2>
                    <span class="text-xs text-slate-400 font-mono tracking-widest uppercase">v2.0 // Live Feed</span>
                </div>
            </div>

            <!-- Navigation -->
            <nav class="hidden md:flex items-center gap-1 bg-surface-dark/50 p-1 rounded border border-surface-border">
                <a class="px-4 py-1.5 text-sm font-medium text-white bg-primary/20 border border-primary/30 rounded-sm shadow-[0_0_10px_rgba(43,75,238,0.2)]" href="#" onclick="return false;">Dashboard</a>
                <a class="px-4 py-1.5 text-sm font-medium text-slate-400 hover:text-white hover:bg-white/5 rounded-sm transition-colors" href="#" onclick="return false;">Intelligence</a>
                <a class="px-4 py-1.5 text-sm font-medium text-slate-400 hover:text-white hover:bg-white/5 rounded-sm transition-colors" href="#" onclick="return false;">Assets</a>
            </nav>
        </div>

        <div class="flex items-center gap-4">
            <!-- Search bar -->
            <div class="hidden lg:flex items-center h-9 w-64 bg-surface-dark border border-surface-border focus-within:border-primary focus-within:shadow-neon transition-all rounded-sm">
                <span class="material-symbols-outlined text-slate-500 ml-3 text-[18px]">search</span>
                <input id="searchInput" class="bg-transparent border-none text-sm text-white placeholder-slate-600 w-full focus:ring-0 font-mono" placeholder="SEARCH CVE-ID..." type="text"/>
            </div>

            <!-- Icons -->
            <div class="flex gap-2">
                <button class="size-9 flex items-center justify-center rounded-sm bg-surface-dark border border-surface-border text-slate-400 hover:text-primary hover:border-primary transition-colors relative" aria-label="Notifications">
                    <span class="material-symbols-outlined text-[20px]">notifications</span>
                    <span class="absolute top-1.5 right-2 size-1.5 bg-accent-pink rounded-full shadow-neon-pink animate-pulse"></span>
                </button>
                <button class="size-9 flex items-center justify-center rounded-sm bg-surface-dark border border-surface-border text-slate-400 hover:text-white hover:border-white transition-colors" aria-label="User profile">
                    <span class="material-symbols-outlined text-[20px]">account_circle</span>
                </button>
            </div>
        </div>
    </div>
</header>

<!-- Main Content -->
<main class="flex-1 flex flex-col p-6 gap-6 max-w-[1920px] mx-auto w-full">

    <!-- Filter Bar -->
    <section class="flex flex-wrap items-center justify-between gap-4">
        <div class="flex flex-wrap gap-2">
            <div class="flex items-center h-8 bg-surface-dark border border-surface-border rounded-sm px-3 gap-2">
                <span class="material-symbols-outlined text-primary text-[18px]">tune</span>
                <span class="text-xs font-bold text-slate-400 uppercase tracking-wider">Filters:</span>
            </div>

            <!-- Vendor Filter -->
            <div class="relative">
                <select id="vendorFilter" class="appearance-none h-8 rounded-sm bg-primary/10 border border-primary/40 px-3 pr-8 text-primary-glow text-xs font-medium uppercase tracking-wide hover:bg-primary/20 hover:shadow-neon transition-all cursor-pointer focus:outline-none focus:ring-0">
                    <option value="">Vendor: All Systems</option>
                    <option value="Microsoft">Vendor: Microsoft</option>
                    <option value="Google">Vendor: Google</option>
                    <option value="Apache">Vendor: Apache</option>
                    <option value="Atlassian">Vendor: Atlassian</option>
                    <option value="Cisco">Vendor: Cisco</option>
                </select>
                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-primary">
                    <span class="material-symbols-outlined text-[16px]">arrow_drop_down</span>
                </div>
            </div>

            <!-- Severity Filter -->
            <div class="relative">
                <select id="severityFilter" class="appearance-none h-8 rounded-sm bg-surface-dark border border-surface-border px-3 pr-8 text-slate-300 text-xs font-medium uppercase tracking-wide hover:border-slate-500 transition-all cursor-pointer focus:outline-none focus:ring-0">
                    <option value="">Severity: All</option>
                    <option value="CRITICAL">Severity: Critical</option>
                    <option value="HIGH">Severity: High</option>
                    <option value="MEDIUM">Severity: Medium</option>
                    <option value="LOW">Severity: Low</option>
                </select>
                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-slate-400">
                    <span class="material-symbols-outlined text-[16px]">arrow_drop_down</span>
                </div>
            </div>

            <!-- KEV Filter -->
            <div class="relative">
                <select id="kevFilter" class="appearance-none h-8 rounded-sm bg-surface-dark border border-surface-border px-3 pr-8 text-slate-300 text-xs font-medium uppercase tracking-wide hover:border-slate-500 transition-all cursor-pointer focus:outline-none focus:ring-0">
                    <option value="">KEV: All</option>
                    <option value="true">KEV: Active Exploit Only</option>
                    <option value="false">KEV: No Active Exploit</option>
                </select>
                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-slate-400">
                    <span class="material-symbols-outlined text-[16px]">arrow_drop_down</span>
                </div>
            </div>

            <!-- EPSS Threshold Filter -->
            <div class="relative">
                <select id="epssFilter" class="appearance-none h-8 rounded-sm bg-surface-dark border border-surface-border px-3 pr-8 text-slate-300 text-xs font-medium uppercase tracking-wide hover:border-slate-500 transition-all cursor-pointer focus:outline-none focus:ring-0">
                    <option value="">EPSS: All</option>
                    <option value="0.7">EPSS: >70%</option>
                    <option value="0.5">EPSS: >50%</option>
                    <option value="0.3">EPSS: >30%</option>
                </select>
                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-slate-400">
                    <span class="material-symbols-outlined text-[16px]">arrow_drop_down</span>
                </div>
            </div>
        </div>

        <div class="flex items-center gap-3">
            <span id="lastSync" class="text-xs text-slate-500 font-mono">LAST SYNC: --:--:--</span>
            <button id="refreshBtn" class="flex items-center gap-2 text-xs font-bold text-primary hover:text-white transition-colors uppercase tracking-wide" onclick="refreshData()">
                <span class="material-symbols-outlined text-[16px]">refresh</span>
                Refresh Data
            </button>
        </div>
    </section>

    <!-- KPI Cards and Charts -->
    <section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">

        <!-- Total Vulnerabilities Card -->
        <div class="glass-panel rounded-sm p-5 flex flex-col relative overflow-hidden group">
            <div class="flex justify-between items-start mb-2">
                <div class="flex-1">
                    <h3 class="text-slate-400 text-xs font-mono uppercase tracking-widest mb-1">Total Vulnerabilities</h3>
                    <div class="flex items-baseline gap-3">
                        <span id="totalVulns" class="text-3xl font-bold text-white tracking-tight">0</span>
                        <span id="totalChange" class="text-xs font-bold text-accent-cyan bg-accent-cyan/10 px-1.5 py-0.5 rounded-sm">--</span>
                    </div>
                </div>
                <span class="material-symbols-outlined text-slate-600 text-[32px]">bug_report</span>
            </div>
        </div>

        <!-- KEV Count Card -->
        <div class="glass-panel rounded-sm p-5 flex flex-col relative overflow-hidden group">
            <div class="flex justify-between items-start mb-2">
                <div class="flex-1">
                    <h3 class="text-slate-400 text-xs font-mono uppercase tracking-widest mb-1">KEV Active Exploits</h3>
                    <div class="flex items-baseline gap-3">
                        <span id="kevCount" class="text-3xl font-bold text-accent-pink tracking-tight">0</span>
                        <span id="kevPercentage" class="text-xs font-bold text-accent-pink bg-accent-pink/10 px-1.5 py-0.5 rounded-sm">0%</span>
                    </div>
                </div>
                <span class="material-symbols-outlined text-accent-pink text-[32px] animate-pulse-slow">warning</span>
            </div>
        </div>

        <!-- High EPSS Card -->
        <div class="glass-panel rounded-sm p-5 flex flex-col relative overflow-hidden group">
            <div class="flex justify-between items-start mb-2">
                <div class="flex-1">
                    <h3 class="text-slate-400 text-xs font-mono uppercase tracking-widest mb-1">High EPSS (>70%)</h3>
                    <div class="flex items-baseline gap-3">
                        <span id="highEpssCount" class="text-3xl font-bold text-white tracking-tight">0</span>
                        <span id="highEpssPercentage" class="text-xs font-bold text-orange-500 bg-orange-500/10 px-1.5 py-0.5 rounded-sm">0%</span>
                    </div>
                </div>
                <span class="material-symbols-outlined text-orange-500 text-[32px]">trending_up</span>
            </div>
        </div>

        <!-- New This Week Card -->
        <div class="glass-panel rounded-sm p-5 flex flex-col relative overflow-hidden group">
            <div class="flex justify-between items-start mb-2">
                <div class="flex-1">
                    <h3 class="text-slate-400 text-xs font-mono uppercase tracking-widest mb-1">New This Week</h3>
                    <div class="flex items-baseline gap-3">
                        <span id="newWeekCount" class="text-3xl font-bold text-white tracking-tight">0</span>
                        <span id="newTodayCount" class="text-xs font-bold text-primary bg-primary/10 px-1.5 py-0.5 rounded-sm">0 today</span>
                    </div>
                </div>
                <span class="material-symbols-outlined text-primary text-[32px]">new_releases</span>
            </div>
        </div>

    </section>

    <!-- Trend Chart Section -->
    <section class="glass-panel rounded-sm p-6 flex flex-col relative overflow-hidden">
        <div class="flex justify-between items-start mb-4">
            <div>
                <h3 class="text-slate-400 text-xs font-mono uppercase tracking-widest mb-1">Vulnerability Trend</h3>
                <div class="flex items-baseline gap-3">
                    <span class="text-xl font-bold text-white tracking-tight">Last 30 Days</span>
                </div>
            </div>
            <span class="material-symbols-outlined text-slate-600">show_chart</span>
        </div>
        <div class="flex-1 w-full" style="min-height: 300px; max-height: 400px;">
            <canvas id="trendChart"></canvas>
        </div>
    </section>

    <!-- Vulnerability Table -->
    <div class="flex items-center justify-between mt-4">
        <h2 class="text-xl font-bold text-white tracking-tight flex items-center gap-2">
            <span class="material-symbols-outlined text-primary text-[24px]">view_list</span>
            Vulnerability Feed
        </h2>
        <div class="flex items-center gap-4">
            <div class="flex items-center gap-2">
                <span class="text-xs text-slate-500 font-mono">ROWS:</span>
                <div class="relative group">
                    <select id="rowsPerPage" class="appearance-none bg-surface-dark border border-surface-border text-xs text-slate-400 font-mono py-1 pl-3 pr-8 rounded-sm focus:border-primary focus:ring-0 focus:outline-none cursor-pointer hover:text-white hover:border-slate-500 transition-colors">
                        <option>10</option>
                        <option selected>20</option>
                        <option>50</option>
                        <option>100</option>
                    </select>
                    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-slate-400">
                        <span class="material-symbols-outlined text-[16px]">arrow_drop_down</span>
                    </div>
                </div>
            </div>
            <div class="h-4 w-px bg-surface-border"></div>
            <div class="flex items-center gap-2">
                <button id="firstPageBtn" class="size-8 flex items-center justify-center rounded-sm border border-surface-border text-slate-400 hover:text-white hover:bg-surface-border transition-colors" aria-label="First page">
                    <span class="material-symbols-outlined text-[20px]">first_page</span>
                </button>
                <button id="prevPageBtn" class="size-8 flex items-center justify-center rounded-sm border border-surface-border text-slate-400 hover:text-white hover:bg-surface-border transition-colors" aria-label="Previous page">
                    <span class="material-symbols-outlined text-[20px]">chevron_left</span>
                </button>
                <div id="pageInfo" class="px-3 py-1 bg-surface-dark border border-surface-border rounded-sm text-xs text-slate-400 font-mono">
                    PAGE 1 / 1
                </div>
                <button id="nextPageBtn" class="size-8 flex items-center justify-center rounded-sm border border-surface-border text-slate-400 hover:text-white hover:bg-surface-border transition-colors" aria-label="Next page">
                    <span class="material-symbols-outlined text-[20px]">chevron_right</span>
                </button>
                <button id="lastPageBtn" class="size-8 flex items-center justify-center rounded-sm border border-surface-border text-slate-400 hover:text-white hover:bg-surface-border transition-colors" aria-label="Last page">
                    <span class="material-symbols-outlined text-[20px]">last_page</span>
                </button>
            </div>
        </div>
    </div>

    <div class="flex-1 overflow-hidden glass-panel border border-surface-border rounded-sm flex flex-col">
        <div class="overflow-auto custom-scrollbar" style="max-height: 600px;">
            <table class="w-full text-left border-collapse">
                <thead class="sticky top-0 bg-surface-dark z-10 shadow-sm border-b border-surface-border">
                    <tr>
                        <th class="p-4 text-xs font-bold text-slate-400 uppercase tracking-widest font-mono cursor-pointer hover:text-white hover:bg-surface-border/50 transition-colors group" onclick="sortTable('cve_id')">
                            <div class="flex items-center gap-2">
                                CVE ID
                                <span class="material-symbols-outlined text-[14px] opacity-0 group-hover:opacity-100 transition-opacity">unfold_more</span>
                            </div>
                        </th>
                        <th class="p-4 text-xs font-bold text-slate-400 uppercase tracking-widest font-mono cursor-pointer hover:text-white hover:bg-surface-border/50 transition-colors group" onclick="sortTable('vendor')">
                            <div class="flex items-center gap-2">
                                Vendor / Product
                                <span class="material-symbols-outlined text-[14px] opacity-0 group-hover:opacity-100 transition-opacity">unfold_more</span>
                            </div>
                        </th>
                        <th class="p-4 text-xs font-bold text-slate-400 uppercase tracking-widest font-mono cursor-pointer hover:text-white hover:bg-surface-border/50 transition-colors group" onclick="sortTable('cvss')">
                            <div class="flex items-center gap-2">
                                Severity
                                <span class="material-symbols-outlined text-[14px] opacity-0 group-hover:opacity-100 transition-opacity">unfold_more</span>
                            </div>
                        </th>
                        <th class="p-4 text-xs font-bold text-slate-400 uppercase tracking-widest font-mono cursor-pointer hover:text-white hover:bg-surface-border/50 transition-colors group" onclick="sortTable('kev')">
                            <div class="flex items-center gap-2">
                                Status
                                <span class="material-symbols-outlined text-[14px] opacity-0 group-hover:opacity-100 transition-opacity">unfold_more</span>
                            </div>
                        </th>
                        <th class="p-4 text-xs font-bold text-slate-400 uppercase tracking-widest font-mono w-1/3">
                            <div class="flex items-center gap-2">
                                Description
                            </div>
                        </th>
                        <th class="p-4 text-xs font-bold text-slate-400 uppercase tracking-widest font-mono text-right cursor-pointer hover:text-white hover:bg-surface-border/50 transition-colors group" onclick="sortTable('published')">
                            <div class="flex items-center justify-end gap-2">
                                Published
                                <span class="material-symbols-outlined text-[14px] opacity-0 group-hover:opacity-100 transition-opacity">unfold_more</span>
                            </div>
                        </th>
                    </tr>
                </thead>
                <tbody id="vulnTableBody" class="divide-y divide-surface-border">
                    <!-- Table rows will be populated by JavaScript -->
                </tbody>
            </table>
        </div>
        <div class="h-0.5 bg-gradient-to-r from-transparent via-primary to-transparent opacity-50"></div>
    </div>

</main>

<!-- Background Effects -->
<div class="pointer-events-none fixed top-0 left-0 w-full h-full z-0 overflow-hidden">
    <div class="absolute top-[20%] left-[5%] w-96 h-96 bg-primary/5 rounded-full blur-[100px]"></div>
    <div class="absolute bottom-[10%] right-[5%] w-[500px] h-[500px] bg-accent-pink/5 rounded-full blur-[120px]"></div>
</div>

<script src="app.js"></script>

</body>
</html>
